<!DOCTYPE html>
<html lang="pt-br">

<head>
    <link rel="shortcut icon" href="../assets/icon/favicon2.ico" type="image/x-icon">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Radar do surf | Dashboards</title>
    <link rel="stylesheet" href="../css/dashboard.css">
    <link rel="icon" href="../assets/imgs/logo.png">
    <!-- scripts do Chart.js - 2022-1 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</head>

<!-- <body onload=" atualizarFeed()"> -->

<body onload="graficoBarra()">
    <div class="fundo">
        <div class="quadradao">
            <div class="menu">
                <img src="/public/assets/imgs/logo.png" alt="">
                <a href="dashboard.html">
                    <p>Inicio</p>
                </a>
                <a href="../quiz.html">
                    <p>Refazer Quiz</p>
                </a>

                <a href="../index.html">
                    <p>Sair</p>
                </a>
            </div>
            <div class="conjunto">
                <div class="texto">
                    <p>Olá <b id="puxar"></b>, Seja Bem-vindo!</p>
                </div>

    <div class="kpi">
    <div class="kpicard">

        <div class="cardkp kpi1">
            <h3> Prancha com maior<br>resultado</h3>
            <p>
                arquivo teste
            </p>
        </div>

        <div class="cardkp kpi3">
            <h3>
                Prancha com menor<br>resultado
            </h3>
            <p>
                Lorem ipsum, dolor sit amet consectetur adipisicing elit. 
                Incidunt voluptas voluptatum nobis vel molestias laudantium odit fuga odio, 
                reprehenderit labore beatae tempore ipsum sint magnam quasi! 
                Mollitia voluptates qui saepe?
            </p>
        </div>

    </div>
</div>
                <div class="graficos">
                    <div class="barra">
                        <canvas id="mychart1"></canvas>

                    </div>
                    <div class="outro">
                        <canvas id="mychart2"></canvas>

                    </div>
                </div>
            </div>
        </div>
    </div>

</body>

</html>

<script>

    function graficoBarra(){
        
        var nomeLogin = document.getElementById('puxar')
        
        nomeLogin = sessionStorage.NOME_USUARIO

        fetch("/medidas/mostrarGrafico", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            }
        }).then(function (response) {
            if (response.ok) {
                response.json().then(function (resposta){
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                
                let longboard = 0
                let shortboard = 0
                let gunboard = 0
                let fishboard = 0
                let funboard = 0

                resposta.forEach(item => {
                    longboard = item.longboard
                    shortboard = item.shortboard
                    gunboard = item.gunboard
                    fishboard = item.fishboard
                    funboard = item.funboard
                });

                


        const ctxbar = document.getElementById('mychart1');
    new Chart(ctxbar, {
        type: 'bar',
        data: {
            labels: ['Tipo de pranchas'],
            datasets: [{
                label: 'Longboard',
                data: [longboard],
                backgroundColor: '#80EF80',
                pointRadius: 4.5,
                borderWidth: 0,

            },
            {
                label: 'Shortboard',
                data: [shortboard],
                backgroundColor: '#01579b',
                pointRadius: 4.5,
                borderWidth: 0,


            },
            {
                label: 'Funboard',
                data: [funboard],
                backgroundColor: 'brown',
                pointRadius: 4.5,
                borderWidth: 0,

            },
            {
                label: 'Gunboard',
                data: [gunboard],
                backgroundColor: '#013a4a',
                pointRadius: 4.5,
                borderWidth: 0,

            },
            {
                label: 'Fishboard',
                data: [fishboard],
                backgroundColor: 'pink',
                pointRadius: 4.5,
                borderWidth: 0,

            }],

        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            indexAxis: 'x',
            scales: {
                y: {
                    beginAtZero: true,
                    title: { display: true, text: 'Quantidade de resultados' },
                }
            }
        }
    });
    })
        }else{
            console.error(`O dado não foi encontrado!`)
        }
    })
        .catch(function (error){
            console.error(`Erro para obter dados: ${error.message}`);
        })
    }

    const ctxPolar = document.getElementById('mychart2')
    new Chart(ctxPolar, {
        type: 'doughnut',
        data : {
            labels: [
                'Longboard',
                'Shortboard',
                'Gunboard',
                'Funboard',
                'Fishboard'
            ],
            datasets: [{
                label: 'My First Dataset',
                data: [2, 2, 2],
                backgroundColor: [
                    'red',
                    'green',
                    'brown'
                ],
                hoverOffset: 4
            }]
        }
    });
</script>